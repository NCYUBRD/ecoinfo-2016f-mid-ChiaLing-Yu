---
title: "1033264_mid"
author: "æ¸¸å?‰ç??"
date: "2016å¹?11???29?—¥"
output: html_document
---

###ä¸€?€è?‹éš¨æ©Ÿç”¢??? 10000 çµ„æ­£?•´?•¸?„²å­˜æ?? vector ? ¼å¼ï?Œä¸¦è¼¸å‡º??? random10k.csv
```{r}
#?š¨æ©Ÿç”¢???10000çµ„æ­£?•´?•¸
random10k <- c(sample.int(10000))
print(random10k)
#å°‡ä?–è¼¸?‡º??? random10k.csv
write.csv(random10k, 'C:\\Users\\qwas8_000\\Desktop\\R studio class/random10k.csv')
```

###äºŒã€è?‹ä½¿?”¨ for è¿´å?ˆå?—å‡º 15 ?€‹è²»å¸ƒç?è¥¿(Fibonacci)?•¸???
```{r}
#ä½¿ç”¨ for è¿´å?ˆå?—å‡º 15 ?€‹è²»å¸ƒç?è¥¿(Fibonacci)?•¸???
sequence <- 15
fib <- numeric(sequence)
#??‡å?šç¬¬ä¸€?€‹æ•¸?€¼ç‚º1,ç¬¬ä?Œå€‹æ•¸?€¼ç‚º2
fib <- integer(15)
fib[1] <- 1
fib[2] <- 2
for(i in 3:15){fib[i] <- fib[i-2]+fib[i-1]}
print(fib)
```

###ä¸‰ã€è?‹å?? sample_data.txt è¼¸å…¥?€? R ?…§ï¼Œä¸¦å®Œæ?ä»¥ä¸‹è?ˆç??
```{r}
#å®‰è?dplyr,ä¸¦å?‡è?‡æ?™è?‰æ?›ç‚ºdplyr? ¼å¼?
#è¼¸å…¥library,è¨­å?šå·¥ä½œç›®???,å°‡sample_data.txt?Œ¯?…¥rä¸?
install.packages('data.table')
install.packages('lazyeval')
library(data.table)
library(dplyr)
setwd('C:\\Users\\qwas8_000\\Desktop\\R studio class')
```

###(a) å°? yyyymmddhh è½‰æ?? POSIXct ??‚é?“æˆ³è¨˜æ ¼å¼ï?? ä¸¦æ–°å¢ç‚ºä¸€?€‹æ??(variable)ï¼Œå‘½??ç‚º timestamp?€‚ä¸¦å°‡æ­¤ sample data è¼¸å‡º?‚º sample_data_parsed.csv (ä»¥é€—è?Ÿå?†é?”ï?Œå…·??‰æ?„ä?å?ç¨±)
```{r}
#å°?-9996?€?-9997?€?-9999?•¸?€¼è?‰æ?›ç‚ºNAï¼Œä¸¦è¼¸å‡º?‚ºsample_data_parsed.csv

sample_data_parsed <- fread('C:\\Users\\qwas8_000\\Desktop\\R studio class/sample_data.txt' , header = TRUE , na.strings=c('-9996','-9997','-9999'))
```

```{r}

library(dplyr)
#å°? yyyymmddhh è½‰æ?? POSIXct ??‚é?“æˆ³è¨˜æ ¼å¼?,??å?è¨­ä¸€?€‹æ??(variable),?‘½??ç‚ºtimestamp?€‚æ?‡å?šå?Ÿå?‹è?‡æ?™ç¬¬ä¸€æ¬?,?„¶å¾Œå?ˆä½µå¤šç?„ä?€?€‹æ?„ä?timestamp
sample_data_parsed[, timestamp:= as.POSIXct(strptime(yyyymmddhh-1, "%Y%m%d%H"))]
```

```{r}
#??ˆä½µå¤šå€‹æ?„ä??(year,month,day)
sample_data_parsed[, year:= format.Date(timestamp, "%Y")]
sample_data_parsed[, yearmonth:= format.Date(timestamp, "%Y-%m")]
sample_data_parsed[, yearmonthday:= format.Date(timestamp, "%Y-%m-%d")]
sample_data_parsed[, month:= format.Date(timestamp, "%m")]
sample_data_parsed[, day:= format.Date(timestamp, "%d")]
```

```{r}
#å°‡ä?–è¼¸?‡º??sample_data_parsed.csv
write.csv(sample_data_parsed, 'C:\\Users\\qwas8_000\\Desktop\\R studio class/sample_data_parsed.csv')
```


###(b) è«‹è?ˆç?? 2014 å¹´è‡³ 2015 å¹´é€™å€‹æ¸¬ç«™ç?„æ?æ?ˆå¹³??‡æ°£æº«ã€æ?æ?ˆå¹³??‡æ?•åº¦?€æ?æ?ˆç´¯ç©é?æ°´ï¼? ä¸¦ç”¨è¡¨æ ¼??ˆç¾?€?
```{r}
#å°‡è?‡æ?™è?‰æ?›ç‚ºtbl_df??„æ ¼å¼?
tbl_data_t <- tbl_df(sample_data_parsed)
#å°‡å¹´??ˆå?ˆä½µ
month_group <- group_by(tbl_data_t,yearmonth)
```

```{r}
#è¨ˆç?—æ?æ?ˆå¹³??‡æº«åº?
mean_t <- summarise(month_group,mean_1=mean(TX01,na.rm = T))

#è¨ˆç?—æ?æ?ˆå¹³??‡æ?•åº¦
mean_w <- summarise(month_group,mean_2=mean(RH01,na.rm = T))

#è¨ˆç?—ç´¯ç©é?æ°´
mean_f <- summarise(month_group,mean_3=sum(PP01,na.rm = T))
```

```{r}
#??ˆä½µè¡¨æ ¼
mean_tw <- dplyr::full_join(mean_t,mean_w,by="yearmonth")
mean_twf <- dplyr::full_join(mean_tw,mean_f,by="yearmonth")

#å°‡è¡¨? ¼è¡Œå?—äº¤???
tranmean_twf <- t(mean_twf)
```


###(c) è«‹è?ˆç?? 2014 å¹´å?? 2015 å¹´æ?€?†·??ˆå?†åˆ¥?˜¯?œ¨?“ª?€‹æ?ˆä»½ï¼?
```{r}
arrmean_1 <- arrange(mean_twf,mean_1)

#?”±æ­¤å¯?Ÿ¥2014å¹´å??2015å¹´æ?€?†·??ˆå?†ç‚º1???
```

###(d) ?œ¨ 2015 å¹´æ?€?†·??„é‚£?€‹æ?ˆä»½ä¸­ï?Œè©²??ˆä¸­æ¯æ—¥??„æ?€ä½æº«å¹³å?‡æ˜¯å¹¾åº¦Cï¼?
```{r}
year201501_1 <- filter(tbl_data_t,yearmonth=="2015-01")
year201501_2 <- group_by(year201501_1,month,day)
year201501_3 <- summarise(year201501_2,min=min(TX01,na.rm = T))
summarise(year201501_3, mean(min))


#?”±æ­¤å¯?Ÿ¥??€ä½æº«å¹³å?‡ç‚º14.49032
```

###(e) è«‹è?ˆç?? 2014 å¹´å?? 2015 å¹´ä¸­ï¼Œæ?€?†±??„æ?ˆå?†åˆ¥?˜¯?œ¨?“ª?€‹æ?ˆä»½ï¼?
```{r}
arrmean_1 <- arrange(mean_twf,mean_1)

#?”±æ­¤å¯?Ÿ¥2014å¹?7??ˆå??2015å¹?6??ˆç‚º??€?†±???
```

###(f) è«‹è?ˆç?? 2014 å¹´æ?€?†±??„æ?ˆä»½ä¸­ï?Œè©²??ˆç?„æ?æ—¥??€é«˜æº«å¹³å?‡ç‚ºå¹¾åº¦C?
```{r}
year201407_1 <- filter(tbl_data_t,yearmonth=="2014-07")
year201407_2 <- group_by(year201407_1,month,day)
year201407_3 <- summarise(year201407_2,max=max(TX01,na.rm = T))
summarise(year201407_3, mean(max))

#?”±æ­¤å¯?Ÿ¥??€é«˜æº«å¹³å?‡ç‚º34.92258
```

###(g) è«‹ç?—å‡º 2014 ?‡³ 2015 å¹´ä¸­ï¼Œæ?€æ¿•æ?ˆä»½??„å¹³??‡æº«åº?
```{r}
arrwet_1 <- arrange(mean_twf,mean_2)

#?”±æ­¤å¯?Ÿ¥2014å¹?9??ˆå??2015å¹?8??ˆç‚º??€æ¿•æ??

#? ¹??šmean_twf?¯?Ÿ¥201409??„å¹³??‡æº«åº¦ç‚º28.75835
#? ¹??šmean_twf?¯?Ÿ¥201508??„å¹³??‡æº«åº¦ç‚º27.82826
```
###(h) è«‹è?ˆç?—æ?å€‹æ?ˆç?„æ?ˆæº«å·?(æ¯æ?ˆæ?€é«˜æº«æ¸›å»æ¯æ?ˆæ?€ä½æº«ï¼Œå?–å…©å¹´å¹³???)ï¼Œå¹³??‡æ?ˆæº«å·®æ?€å¤§ç?„æ˜¯?“ª?€‹æ?ˆï??
```{r}
#å°‡å¹´??ˆæ—¥??ˆä½µ
ymd_group <- group_by(tbl_data_t,year,month,day)
#è¨ˆç?—æ?æ?ˆæ—¥å¹³å?‡æº«
daymean_t <- summarise(ymd_group,mean_a=mean(TX01,na.rm = T))
#å°‡ymd_groupä¸­ç?„å¹´??ˆå?ˆä½µ
ym_group <- group_by(daymean_t,year,month)
#?‰¾?‡º??€å¤§å€¼è?‡æ?€å°å€?
big_small <- summarise_all(ym_group,funs(max(mean_a),min(mean_a)))
#?¸?‡º??€è¦ç?„æ?„ä?ä?†å?šè?ˆç??
big_small_select <- select(big_small,year,month,mean_a_max,mean_a_min)
#?–°å¢ä?€?€‹æ?„ä?ä¸¦è¨ˆç?—æ?å€‹æ?ˆç?„æ?ˆæº«å·?
month_b_s <- mutate(big_small_select,b_s=mean_a_max-mean_a_min)
#??’å?month_b_s
arrmonth_b_s <- arrange(month_b_s,b_s)
#??–å…©å¹´å¹³???
avg_month_b_s <- aggregate(arrmonth_b_s$b_s~arrmonth_b_s$month,FUN=mean)

#?”±æ­¤å¯?Ÿ¥å¹³å?‡æ?ˆæº«å·®æ?€å¤§ç?„æ˜¯2???
```

###(i) è«‹è?ˆç?—é€™å…©å¹´ç?„å¹´æº«å·®å¹³å??(æ¯å¹´??€é«˜æº«æ¸›å»??€ä½æº«)
```{r}
#å°‡å¹´??ˆå?ˆä½µ
ym_group1 <- group_by(tbl_data_t,year,month)
#è¨ˆç?—æ?å¹´??ˆå?‡æº«
meanym_group1 <- summarise(ym_group1,mean_b=mean(TX01,na.rm = T))
#å°‡meanym_group1ä¸­ç?„å¹´??ˆä½µ
y_group1 <- group_by(meanym_group1,year)
#?‰¾?‡º??€å¤§å€¼è?‡æ?€å°å€?
big_small_1 <- summarise_all(y_group1,funs(max(mean_b),min(mean_b)))
#?¸?‡º??€è¦ç?„æ?„ä?ä?†å?šè?ˆç??
big_small_1_select <- select(big_small_1,year,mean_b_max,mean_b_min)
#?–°å¢ä?€?€‹æ?„ä?ä¸¦è¨ˆç?—å¹´æº«å·®
year_b_s <- mutate(big_small_1_select,b_s_1=mean_b_max-mean_b_min)
#??–å¹³???
avg_year_b_s <- summarise(year_b_s,mean(b_s_1))

#?”±æ­¤å¯?Ÿ¥å¹´æº«å·®å¹³??‡ç‚º11.27245
```

###(j) æº«é?æ?‡æ•¸(warmth index)?˜¯ Kira (1945) ??å‡º??„ä?€?€‹ç?Ÿæ?‹æ°£?€™æ?‡æ?™ï?Œå…¶è¨ˆç?—æ–¹å¼ç‚º:

###(k) è«‹ä½¿?”¨ climatol package ç¹ªè£½ 2014 ?‡³ 2015 ??„ç?Ÿæ?‹æ°£?€™å??(Ecological climate diagrams)?€? ??ç¤ºï¼šä? é?€è¦è?ˆç?—å‡ºæ¯å€‹æ?ˆç?„ç´¯ç©é?æ°´å¹³å?‡ã€æ?æ—¥??€é«˜æº«å¹³å?‡ã€æ?æ—¥??€ä½æº«å¹³å?‡ã€æ?æ?ˆç?•å?æ?€ä½æº«?€? ?¯??ƒè€ƒç¹ªè£½ç?Ÿæ?‹æ°£?€™å??


###??›ã€è?‹è?ˆç?? Table 2 ä¸­ç?„ä?‹å?—å?„å?é?? (30%)

```{r}
#ä½¿ç”¨read.tableä¾†è?€??–è?‡æ??

penghu_env.csv <- tbl_df(read.table('C:\\Users\\qwas8_000\\Desktop\\R studio class/penghu_env.csv', header = T, sep = ","))

```

###(a) è«‹è?ˆç?—å?„å³¶?’°å¢ƒå? å??(total_cover, C, EC, ..., etc.) ??„å¹³??‡ã€? ç¬¬ä?€??›å?†ä?æ•¸?€ä¸­ä½æ•¸?€ç¬¬ä¸‰å?›å?†ä?æ•¸?€æ?€å¤§å€¼å?Šæ?€å°å€¼ä»¥??Šæ?™æ?–å·®ï¼Œä¸¦?•´??†æ?å?‚ä?‹è¡¨? ¼ï¼?

```{r}

#?¸???1~5è¡Œé‹¤? ­å¶¼ç?„è?‡æ??
p1 <- penghu_env.csv[1:5,]
#?‹¤? ­å¶¼total_cover??„å¹³???
summarise(p1,mean_0=mean(total_cover,na.rm = T))
#?”±æ­¤å¯?Ÿ¥å¹³å??=75
```
```{r}
#?‹¤? ­å¶¼total_cover??„ç¬¬ä¸€??›å?†ä?æ•¸
summarise(p1,Q1_0=quantile(total_cover,0.25,na.rm = T))
#?‹¤? ­å¶¼total_cover??„ä¸­ä½æ•¸
summarise(p1,Q2_0=quantile(total_cover,0.5,na.rm = T))
#?‹¤? ­å¶¼total_cover??„ç¬¬ä¸‰å?›å?†ä?æ•¸
summarise(p1,Q3_0=quantile(total_cover,0.75,na.rm = T))

#?”±æ­¤å¯?Ÿ¥Q1=70,Q3=85,ä¸­ä?æ•¸=80
```
```{r}
#?‹¤? ­å¶¼total_cover??„æ?€å¤§å€¼å?Šæ?€å°å€?
summarise(p1,max_0=max(total_cover,na.rm = T))
summarise(p1,min_0=min(total_cover,na.rm = T))

#?”±æ­¤å¯?Ÿ¥??€å¤§å€?=90,??€å°å€?=50
```
```{r}
#?‹¤? ­å¶¼ç?„æ?™æ?–å·®
summarise(p1,sd_0=sd(total_cover,na.rm = T))

#?”±æ­¤å¯?Ÿ¥æ¨™æ?–å·®=0.8414868
```

```{r}
#?‹¤? ­å¶¼total_cover,C,EC,K,Na,N,rock_ratio??„å¹³???
summary_1 <- data.frame(summarize_each(p1, funs(mean)))
```

```{r}
#?¸???6~29è¡Œæ±??‰å¶¼??„è?‡æ??
p2 <- penghu_env.csv[6:29,]
#?±??‰å¶¼total_cover,C,EC,K,Na,N,rock_ratio??„ç¬¬ä¸€??›å?†ä?æ•¸

```


###(b) è«‹å?†åˆ¥??—å‡º C, EC, K, Na, N ??€é«˜ç?„ä?”å€‹æ¨£??€(plotid)

###?€å¸«??‘ç?„è?‡æ?™æ˜¯äº‚ç¢¼,??‘ä?çŸ¥??“æ€éº¼è§?æ±?

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
